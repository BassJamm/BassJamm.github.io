<!doctype html><html lang=en dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>NSGAssistance | BassJamm</title>
<meta name=keywords content="Azure,Networking,NSG"><meta name=description content="Helpful information about Network Security Groups"><meta name=author content="BassJamm"><link rel=canonical href=https://canonical.url/to/page><link crossorigin=anonymous href=/assets/css/stylesheet.d72444526d7ecbdb0015438a7fa89054a658bf759d0542e2e5df81ce94b493ee.css integrity="sha256-1yREUm1+y9sAFUOKf6iQVKZYv3WdBULi5d+BzpS0k+4=" rel="preload stylesheet" as=style><link rel=icon href=http://localhost:1313/favicon.ico><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/favicon-32x32.png><link rel=apple-touch-icon href=http://localhost:1313/apple-touch-icon.png><link rel=mask-icon href=http://localhost:1313/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=http://localhost:1313/posts/december2024/nsgassistance/index.md/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="http://localhost:1313/posts/december2024/nsgassistance/index.md/"><meta property="og:site_name" content="BassJamm"><meta property="og:title" content="NSGAssistance"><meta property="og:description" content="Helpful information about Network Security Groups"><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-01-01T21:17:08+00:00"><meta property="article:modified_time" content="2025-01-01T21:17:08+00:00"><meta property="article:tag" content="Azure"><meta property="article:tag" content="Networking"><meta property="article:tag" content="NSG"><meta property="og:image" content="http://localhost:1313/%3Cimage%20path/url%3E"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://localhost:1313/%3Cimage%20path/url%3E"><meta name=twitter:title content="NSGAssistance"><meta name=twitter:description content="Helpful information about Network Security Groups"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://localhost:1313/posts/"},{"@type":"ListItem","position":2,"name":"NSGAssistance","item":"http://localhost:1313/posts/december2024/nsgassistance/index.md/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"NSGAssistance","name":"NSGAssistance","description":"Helpful information about Network Security Groups","keywords":["Azure","Networking","NSG"],"articleBody":"Azure Network Security Groups (NSGs) are essential tools for managing and securing network traffic in Azure. Acting as virtual firewalls, NSGs allow you to define rules that control inbound and outbound traffic to resources. They are commonly used to protect virtual machines, enforce network segmentation, and ensure secure access within virtual networks.\nRules and Priorities Service Tags Learn more about Virtual Network Service Tags | Microsoft Docs\nService tags simplify network security by grouping IP address prefixes for specific Azure services. These tags are managed and automatically updated by Microsoft, eliminating the need for frequent manual updates when service addresses change.\nFor example, using a service tag like Storage in your network security rules ensures you allow all necessary traffic for Azure Storage without tracking individual IP addresses. This approach reduces complexity and keeps your configurations up-to-date effortlessly.\nRule Priority Rules in Azure Network Security Groups (NSGs) are assigned a priority value between 100 and 4096. Lower numbers indicate higher priority, meaning rules with lower numbers are processed first.\nOnce traffic matches a rule, further processing stops. This means any rules with lower priority (higher numbers) that overlap with higher-priority rules will not be processed. Plan accordingly.\nSome Rule Suggestions Check out the list of suggested rules I have put together, they may not be good for all situations but, give an idea of where to start.\nLink to the Github Gist\nThis would not embed properly in the website, I assume because it is a markdown file.\nFlow Logs NSG flow logs is a feature of Azure Network Watcher that allows you to log information about IP traffic flowing through a network security group (NSG). Flow data is sent to Azure Storage from where you can access it and export it to any visualization tool.\nFlow logs for network security groups | Microsoft doc link\nCommon use cases All of the below information has been ripped out of a Microsoft doc, not my original material.\nNetwork monitoring Identify unknown or undesired traffic. Monitor traffic levels and bandwidth consumption. Filter flow logs by IP and port to understand application behavior. Export flow logs to analytics and visualization tools of your choice to set up monitoring dashboards. Usage monitoring and optimization Identify top talkers in your network. Combine with GeoIP data to identify cross-region traffic. Understand traffic growth for capacity forecasting. Use data to remove overly restrictive traffic rules. Compliance Use flow data to verify network isolation and compliance with enterprise access rules. Network forensics and security analysis Analyze network flows from compromised IPs and network interfaces. Export flow logs to any SIEM or IDS tool of your choice. Reading the flow log Logs are in JSON format and will be outputting in the json file format. The information that is interesting is in the flowtuples section of the json file. Example flow log entry 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 { \"records\": [ { \"time\": \"2018-11-13T12:00:35.3899262Z\", \"systemId\": \"a0fca5ce-022c-47b1-9735-89943b42f2fa\", \"category\": \"NetworkSecurityGroupFlowEvent\", \"resourceId\": \"/SUBSCRIPTIONS/00000000-0000-0000-0000-000000000000/RESOURCEGROUPS/FABRIKAMRG/PROVIDERS/MICROSOFT.NETWORK/NETWORKSECURITYGROUPS/FABRIAKMVM1-NSG\", \"operationName\": \"NetworkSecurityGroupFlowEvents\", \"properties\": { \"Version\": 2, \"flows\": [ { \"rule\": \"DefaultRule_DenyAllInBound\", \"flows\": [ { \"mac\": \"000D3AF87856\", \"flowTuples\": [ \"1542110402,94.102.49.190,10.5.16.4,28746,443,U,I,D,B,,,,\", \"1542110424,176.119.4.10,10.5.16.4,56509,59336,T,I,D,B,,,,\", \"1542110432,167.99.86.8,10.5.16.4,48495,8088,T,I,D,B,,,,\" ] } ] }, { \"rule\": \"DefaultRule_AllowInternetOutBound\", \"flows\": [ { \"mac\": \"000D3AF87856\", \"flowTuples\": [ \"1542110377,10.5.16.4,13.67.143.118,59831,443,T,O,A,B,,,,\", \"1542110379,10.5.16.4,13.67.143.117,59932,443,T,O,A,E,1,66,1,66\", \"1542110379,10.5.16.4,13.67.143.115,44931,443,T,O,A,C,30,16978,24,14008\", \"1542110406,10.5.16.4,40.71.12.225,59929,443,T,O,A,E,15,8489,12,7054\" ] } ] } ] } }, { \"time\": \"2018-11-13T12:01:35.3918317Z\", \"systemId\": \"a0fca5ce-022c-47b1-9735-89943b42f2fa\", \"category\": \"NetworkSecurityGroupFlowEvent\", \"resourceId\": \"/SUBSCRIPTIONS/00000000-0000-0000-0000-000000000000/RESOURCEGROUPS/FABRIKAMRG/PROVIDERS/MICROSOFT.NETWORK/NETWORKSECURITYGROUPS/FABRIAKMVM1-NSG\", \"operationName\": \"NetworkSecurityGroupFlowEvents\", \"properties\": { \"Version\": 2, \"flows\": [ { \"rule\": \"DefaultRule_DenyAllInBound\", \"flows\": [ { \"mac\": \"000D3AF87856\", \"flowTuples\": [ \"1542110437,125.64.94.197,10.5.16.4,59752,18264,T,I,D,B,,,,\", \"1542110475,80.211.72.221,10.5.16.4,37433,8088,T,I,D,B,,,,\", \"1542110487,46.101.199.124,10.5.16.4,60577,8088,T,I,D,B,,,,\", \"1542110490,176.119.4.30,10.5.16.4,57067,52801,T,I,D,B,,,,\" ] } ] } ] } } Flow Tuples flowTuples: String that contains multiple properties for the flow tuple in a comma-separated format\nExample entry: 1493695838,185.170.185.105,10.2.0.4,35370,23,T,I,A,C,1021,588096,8005,4610880\n","wordCount":"656","inLanguage":"en","image":"http://localhost:1313/%3Cimage%20path/url%3E","datePublished":"2025-01-01T21:17:08Z","dateModified":"2025-01-01T21:17:08Z","author":{"@type":"Person","name":"BassJamm"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:1313/posts/december2024/nsgassistance/index.md/"},"publisher":{"@type":"Organization","name":"BassJamm","logo":{"@type":"ImageObject","url":"http://localhost:1313/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://localhost:1313/ accesskey=h title="BassJamm (Alt + H)">BassJamm</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=http://localhost:1313/categories/ title=Categories><span>Categories</span></a></li><li><a href=http://localhost:1313/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://github.com/BassJamm/BassJamm.github.io/tree/main/content title=Github><span>Github</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=http://localhost:1313/external/ title="External Resources"><span>External Resources</span></a></li><li><a href=http://localhost:1313/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=http://localhost:1313/>Home</a>&nbsp;»&nbsp;<a href=http://localhost:1313/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">NSGAssistance</h1><div class=post-description>Helpful information about Network Security Groups</div><div class=post-meta><span title='2025-01-01 21:17:08 +0000 UTC'>January 1, 2025</span>&nbsp;·&nbsp;4 min&nbsp;·&nbsp;656 words&nbsp;·&nbsp;BassJamm&nbsp;|&nbsp;<a href=https://github.com/BassJamm/BassJamm.github.io/tree/main/content/posts/December2024/NSGAssistance/index.md.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#rules-and-priorities aria-label="Rules and Priorities">Rules and Priorities</a><ul><li><a href=#service-tags aria-label="Service Tags">Service Tags</a></li><li><a href=#rule-priority aria-label="Rule Priority">Rule Priority</a></li><li><a href=#some-rule-suggestions aria-label="Some Rule Suggestions">Some Rule Suggestions</a></li></ul></li><li><a href=#flow-logs aria-label="Flow Logs">Flow Logs</a><ul><li><a href=#common-use-cases aria-label="Common use cases">Common use cases</a><ul><li><a href=#network-monitoring aria-label="Network monitoring">Network monitoring</a></li><li><a href=#usage-monitoring-and-optimization aria-label="Usage monitoring and optimization">Usage monitoring and optimization</a></li><li><a href=#compliance aria-label=Compliance>Compliance</a></li></ul></li><li><a href=#reading-the-flow-log aria-label="Reading the flow log">Reading the flow log</a></li><li><a href=#example-flow-log-entry aria-label="Example flow log entry">Example flow log entry</a></li><li><a href=#flow-tuples aria-label="Flow Tuples">Flow Tuples</a></li></ul></li></ul></div></details></div><div class=post-content><p>Azure Network Security Groups (NSGs) are essential tools for managing and securing network traffic in Azure. Acting as virtual firewalls, NSGs allow you to define rules that control inbound and outbound traffic to resources. They are commonly used to protect virtual machines, enforce network segmentation, and ensure secure access within virtual networks.</p><h2 id=rules-and-priorities>Rules and Priorities<a hidden class=anchor aria-hidden=true href=#rules-and-priorities>#</a></h2><h3 id=service-tags>Service Tags<a hidden class=anchor aria-hidden=true href=#service-tags>#</a></h3><p><a href=https://learn.microsoft.com/en-us/azure/virtual-network/service-tags-overview>Learn more about Virtual Network Service Tags | Microsoft Docs</a></p><p>Service tags simplify network security by grouping IP address prefixes for specific Azure services. These tags are managed and automatically updated by Microsoft, eliminating the need for frequent manual updates when service addresses change.</p><p>For example, using a service tag like <code>Storage</code> in your network security rules ensures you allow all necessary traffic for Azure Storage without tracking individual IP addresses. This approach reduces complexity and keeps your configurations up-to-date effortlessly.</p><h3 id=rule-priority>Rule Priority<a hidden class=anchor aria-hidden=true href=#rule-priority>#</a></h3><p>Rules in Azure Network Security Groups (NSGs) are assigned a priority value between 100 and 4096. Lower numbers indicate higher priority, meaning rules with lower numbers are processed first.</p><p>Once traffic matches a rule, further processing stops. This means any rules with lower priority (higher numbers) that overlap with higher-priority rules will not be processed. Plan accordingly.</p><h3 id=some-rule-suggestions>Some Rule Suggestions<a hidden class=anchor aria-hidden=true href=#some-rule-suggestions>#</a></h3><p>Check out the list of suggested rules I have put together, they may not be good for all situations but, give an idea of where to start.</p><p><a href=https://gist.github.com/BassJamm/2741bf13d007d98fd08eb058613a1eea>Link to the Github Gist</a></p><blockquote><p><em>This would not embed properly in the website, I assume because it is a markdown file.</em></p></blockquote><h2 id=flow-logs>Flow Logs<a hidden class=anchor aria-hidden=true href=#flow-logs>#</a></h2><p>NSG flow logs is a feature of Azure Network Watcher that allows you to log information about IP traffic flowing through a network security group (NSG). Flow data is sent to Azure Storage from where you can access it and export it to any visualization tool.</p><p><a href=https://learn.microsoft.com/en-us/azure/network-watcher/network-watcher-nsg-flow-logging-overview>Flow logs for network security groups | Microsoft doc link</a></p><h3 id=common-use-cases>Common use cases<a hidden class=anchor aria-hidden=true href=#common-use-cases>#</a></h3><blockquote><p><em>All of the below information has been ripped out of a Microsoft doc, not my original material.</em></p></blockquote><h4 id=network-monitoring>Network monitoring<a hidden class=anchor aria-hidden=true href=#network-monitoring>#</a></h4><ul><li>Identify unknown or undesired traffic.</li><li>Monitor traffic levels and bandwidth consumption.</li><li>Filter flow logs by IP and port to understand application behavior.</li><li>Export flow logs to analytics and visualization tools of your choice to set up monitoring dashboards.</li></ul><h4 id=usage-monitoring-and-optimization>Usage monitoring and optimization<a hidden class=anchor aria-hidden=true href=#usage-monitoring-and-optimization>#</a></h4><ul><li>Identify top talkers in your network.</li><li>Combine with GeoIP data to identify cross-region traffic.</li><li>Understand traffic growth for capacity forecasting.</li><li>Use data to remove overly restrictive traffic rules.</li></ul><h4 id=compliance>Compliance<a hidden class=anchor aria-hidden=true href=#compliance>#</a></h4><ul><li>Use flow data to verify network isolation and compliance with enterprise access rules.</li><li>Network forensics and security analysis</li><li>Analyze network flows from compromised IPs and network interfaces.</li><li>Export flow logs to any SIEM or IDS tool of your choice.</li></ul><h3 id=reading-the-flow-log>Reading the flow log<a hidden class=anchor aria-hidden=true href=#reading-the-flow-log>#</a></h3><ul><li>Logs are in JSON format and will be outputting in the json file format.</li><li>The information that is interesting is in the flowtuples section of the json file.</li></ul><h3 id=example-flow-log-entry>Example flow log entry<a hidden class=anchor aria-hidden=true href=#example-flow-log-entry>#</a></h3><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">67
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;records&#34;</span>: [
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;time&#34;</span>: <span style=color:#e6db74>&#34;2018-11-13T12:00:35.3899262Z&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;systemId&#34;</span>: <span style=color:#e6db74>&#34;a0fca5ce-022c-47b1-9735-89943b42f2fa&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;category&#34;</span>: <span style=color:#e6db74>&#34;NetworkSecurityGroupFlowEvent&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;resourceId&#34;</span>: <span style=color:#e6db74>&#34;/SUBSCRIPTIONS/00000000-0000-0000-0000-000000000000/RESOURCEGROUPS/FABRIKAMRG/PROVIDERS/MICROSOFT.NETWORK/NETWORKSECURITYGROUPS/FABRIAKMVM1-NSG&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;operationName&#34;</span>: <span style=color:#e6db74>&#34;NetworkSecurityGroupFlowEvents&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;properties&#34;</span>: {
</span></span><span style=display:flex><span>                <span style=color:#f92672>&#34;Version&#34;</span>: <span style=color:#ae81ff>2</span>,
</span></span><span style=display:flex><span>                <span style=color:#f92672>&#34;flows&#34;</span>: [
</span></span><span style=display:flex><span>                    {
</span></span><span style=display:flex><span>                        <span style=color:#f92672>&#34;rule&#34;</span>: <span style=color:#e6db74>&#34;DefaultRule_DenyAllInBound&#34;</span>,
</span></span><span style=display:flex><span>                        <span style=color:#f92672>&#34;flows&#34;</span>: [
</span></span><span style=display:flex><span>                            {
</span></span><span style=display:flex><span>                                <span style=color:#f92672>&#34;mac&#34;</span>: <span style=color:#e6db74>&#34;000D3AF87856&#34;</span>,
</span></span><span style=display:flex><span>                                <span style=color:#f92672>&#34;flowTuples&#34;</span>: [
</span></span><span style=display:flex><span>                                    <span style=color:#e6db74>&#34;1542110402,94.102.49.190,10.5.16.4,28746,443,U,I,D,B,,,,&#34;</span>,
</span></span><span style=display:flex><span>                                    <span style=color:#e6db74>&#34;1542110424,176.119.4.10,10.5.16.4,56509,59336,T,I,D,B,,,,&#34;</span>,
</span></span><span style=display:flex><span>                                    <span style=color:#e6db74>&#34;1542110432,167.99.86.8,10.5.16.4,48495,8088,T,I,D,B,,,,&#34;</span>
</span></span><span style=display:flex><span>                                ]
</span></span><span style=display:flex><span>                            }
</span></span><span style=display:flex><span>                        ]
</span></span><span style=display:flex><span>                    },
</span></span><span style=display:flex><span>                    {
</span></span><span style=display:flex><span>                        <span style=color:#f92672>&#34;rule&#34;</span>: <span style=color:#e6db74>&#34;DefaultRule_AllowInternetOutBound&#34;</span>,
</span></span><span style=display:flex><span>                        <span style=color:#f92672>&#34;flows&#34;</span>: [
</span></span><span style=display:flex><span>                            {
</span></span><span style=display:flex><span>                                <span style=color:#f92672>&#34;mac&#34;</span>: <span style=color:#e6db74>&#34;000D3AF87856&#34;</span>,
</span></span><span style=display:flex><span>                                <span style=color:#f92672>&#34;flowTuples&#34;</span>: [
</span></span><span style=display:flex><span>                                    <span style=color:#e6db74>&#34;1542110377,10.5.16.4,13.67.143.118,59831,443,T,O,A,B,,,,&#34;</span>,
</span></span><span style=display:flex><span>                                    <span style=color:#e6db74>&#34;1542110379,10.5.16.4,13.67.143.117,59932,443,T,O,A,E,1,66,1,66&#34;</span>,
</span></span><span style=display:flex><span>                                    <span style=color:#e6db74>&#34;1542110379,10.5.16.4,13.67.143.115,44931,443,T,O,A,C,30,16978,24,14008&#34;</span>,
</span></span><span style=display:flex><span>                                    <span style=color:#e6db74>&#34;1542110406,10.5.16.4,40.71.12.225,59929,443,T,O,A,E,15,8489,12,7054&#34;</span>
</span></span><span style=display:flex><span>                                ]
</span></span><span style=display:flex><span>                            }
</span></span><span style=display:flex><span>                        ]
</span></span><span style=display:flex><span>                    }
</span></span><span style=display:flex><span>                ]
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        },
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;time&#34;</span>: <span style=color:#e6db74>&#34;2018-11-13T12:01:35.3918317Z&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;systemId&#34;</span>: <span style=color:#e6db74>&#34;a0fca5ce-022c-47b1-9735-89943b42f2fa&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;category&#34;</span>: <span style=color:#e6db74>&#34;NetworkSecurityGroupFlowEvent&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;resourceId&#34;</span>: <span style=color:#e6db74>&#34;/SUBSCRIPTIONS/00000000-0000-0000-0000-000000000000/RESOURCEGROUPS/FABRIKAMRG/PROVIDERS/MICROSOFT.NETWORK/NETWORKSECURITYGROUPS/FABRIAKMVM1-NSG&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;operationName&#34;</span>: <span style=color:#e6db74>&#34;NetworkSecurityGroupFlowEvents&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;properties&#34;</span>: {
</span></span><span style=display:flex><span>                <span style=color:#f92672>&#34;Version&#34;</span>: <span style=color:#ae81ff>2</span>,
</span></span><span style=display:flex><span>                <span style=color:#f92672>&#34;flows&#34;</span>: [
</span></span><span style=display:flex><span>                    {
</span></span><span style=display:flex><span>                        <span style=color:#f92672>&#34;rule&#34;</span>: <span style=color:#e6db74>&#34;DefaultRule_DenyAllInBound&#34;</span>,
</span></span><span style=display:flex><span>                        <span style=color:#f92672>&#34;flows&#34;</span>: [
</span></span><span style=display:flex><span>                            {
</span></span><span style=display:flex><span>                                <span style=color:#f92672>&#34;mac&#34;</span>: <span style=color:#e6db74>&#34;000D3AF87856&#34;</span>,
</span></span><span style=display:flex><span>                                <span style=color:#f92672>&#34;flowTuples&#34;</span>: [
</span></span><span style=display:flex><span>                                    <span style=color:#e6db74>&#34;1542110437,125.64.94.197,10.5.16.4,59752,18264,T,I,D,B,,,,&#34;</span>,
</span></span><span style=display:flex><span>                                    <span style=color:#e6db74>&#34;1542110475,80.211.72.221,10.5.16.4,37433,8088,T,I,D,B,,,,&#34;</span>,
</span></span><span style=display:flex><span>                                    <span style=color:#e6db74>&#34;1542110487,46.101.199.124,10.5.16.4,60577,8088,T,I,D,B,,,,&#34;</span>,
</span></span><span style=display:flex><span>                                    <span style=color:#e6db74>&#34;1542110490,176.119.4.30,10.5.16.4,57067,52801,T,I,D,B,,,,&#34;</span>
</span></span><span style=display:flex><span>                                ]
</span></span><span style=display:flex><span>                            }
</span></span><span style=display:flex><span>                        ]
</span></span><span style=display:flex><span>                    }
</span></span><span style=display:flex><span>                ]
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span></code></pre></td></tr></table></div></div><h3 id=flow-tuples>Flow Tuples<a hidden class=anchor aria-hidden=true href=#flow-tuples>#</a></h3><p>flowTuples: String that contains multiple properties for the flow tuple in a comma-separated format</p><p>Example entry: 1493695838,185.170.185.105,10.2.0.4,35370,23,T,I,A,C,1021,588096,8005,4610880</p></div><footer class=post-footer><ul class=post-tags><li><a href=http://localhost:1313/tags/azure/>Azure</a></li><li><a href=http://localhost:1313/tags/networking/>Networking</a></li><li><a href=http://localhost:1313/tags/nsg/>NSG</a></li></ul><nav class=paginav><a class=next href=http://localhost:1313/posts/december2024/deployeveryoneprint/><span class=title>Next »</span><br><span>DeployEveryOnePrint</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2025 <a href=http://localhost:1313/>BassJamm</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>