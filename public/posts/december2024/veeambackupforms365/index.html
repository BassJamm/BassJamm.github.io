<!doctype html><html lang=en dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Veeam Backup For Microsoft 365 | BassJamm</title>
<meta name=keywords content="Veeam,Microsoft365"><meta name=description content="Notes on Issues, solutions and Reporting for the product"><meta name=author content="BassJamm"><link rel=canonical href=http://localhost:1313/posts/december2024/veeambackupforms365/><link crossorigin=anonymous href=/assets/css/stylesheet.d72444526d7ecbdb0015438a7fa89054a658bf759d0542e2e5df81ce94b493ee.css integrity="sha256-1yREUm1+y9sAFUOKf6iQVKZYv3WdBULi5d+BzpS0k+4=" rel="preload stylesheet" as=style><link rel=icon href=http://localhost:1313/favicon.ico><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/favicon-32x32.png><link rel=apple-touch-icon href=http://localhost:1313/apple-touch-icon.png><link rel=mask-icon href=http://localhost:1313/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=http://localhost:1313/posts/december2024/veeambackupforms365/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="http://localhost:1313/posts/december2024/veeambackupforms365/"><meta property="og:site_name" content="BassJamm"><meta property="og:title" content="Veeam Backup For Microsoft 365"><meta property="og:description" content="Notes on Issues, solutions and Reporting for the product"><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-12-30T16:05:01+00:00"><meta property="article:modified_time" content="2024-12-30T17:52:51+00:00"><meta property="article:tag" content="Veeam"><meta property="article:tag" content="Microsoft365"><meta property="og:image" content="http://localhost:1313/%3Cimage%20path/url%3E"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://localhost:1313/%3Cimage%20path/url%3E"><meta name=twitter:title content="Veeam Backup For Microsoft 365"><meta name=twitter:description content="Notes on Issues, solutions and Reporting for the product"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://localhost:1313/posts/"},{"@type":"ListItem","position":2,"name":"Veeam Backup For Microsoft 365","item":"http://localhost:1313/posts/december2024/veeambackupforms365/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Veeam Backup For Microsoft 365","name":"Veeam Backup For Microsoft 365","description":"Notes on Issues, solutions and Reporting for the product","keywords":["Veeam","Microsoft365"],"articleBody":"Intro Veeam Backup for Microsoft 365 is a reliable solution, but after years of use, I’ve identified areas for improvement. Key challenges include:\nBuilt-in Reporting Limited features often fall short of customer needs, requiring custom PowerShell scripts. Retention Periods: Difficult to audit, making it hard to track data outside of the backup retention window. SharePoint Script Issues: Pre-version 8, Microsoft’s security settings frequently disabled script execution. Group Ownership Gaps: Groups without owners aren’t backed up unless manually addressed. Backup Speed: Microsoft throttling significantly slows job completion times. Easy to lose control: We had various people\\teams look after this product, configuration drift has really left it in a mess in places. Below, I’m sharing what I have found, used and troubleshooted.\nTroubleshooting Scripts Checking the Last Backed up Time for an Object The notes below are for Item-Level Backups, which is based on the last modified date of the items within the backups (Emails, Files, Groups etc). Snapshot level backup retention works the same way accept you lose the whole snapshot not just the items.\nAn object is any one of the following item, User, Group, Site, Team, Organization, OneDrive, Mailbox. The script below helps identify when the object was last successfully backed up. Unfortunately, it does not identify which item in the backup is falling out of scope of the retention but, does give an idea of when items will start being removed from the backup job.\nFor example, in a SharePoint site, the file “Don’t Delete Me”, was last modified on the 1st of September 2021. If the retention is 3 years, the document would have been removed from the backups 4 months ago, but, other data in that site may have been edited in 2024 and so is still in scope of the retention.\nI went a bit mad on the Write-Host commands in this script but, the staff who’d be running this are not all savvy with Powershell so thought more information was better.\nReviewing the VBO Logs You can download the logs using the Veeam Console.\nOpen the Console. Click the Hamburger Menu in the top left. Select Help and Support. Select Support Information. With Collect Logs selected, Click next. Select the proxy server your job is running via. Save the logs to a good location and extract them. The script below doesn’t perform many complex actions; it simply removes some square brackets and creates separate date and time variables in their own columns. However, it simplifies the process, making it easier to continue searching, formatting, and exporting the logs from PowerShell.\nSome of the logs can be over 100,000 lines so there is a progress bar written into the foreach loop for some visual feedback.\nParsing Job Warnings and Errors It’s quite useful to be able to pull out any warnings or errors from the previous jobs. Below is a script that can help do that.\nThe starttime is optional, if you do not provide it, it will provide the most recent job matching the name you provide. Make sure to enter the starttime as a string like the example shows.\nRemoving a User’s License This process can be a bit of a pig, there is a Veeam Blog or KB post here.\nBest Practices Guide If you are looking for what Veeam suggest about how to setup and use this solution, there’s a guide here for version 7.\nJET Database Errors This will not be an issue once upgraded to version 8 as they have swapped over to Postgresql instead of JET.\nError Example Example error, 21/03/2024 20:28:39 :: Failed to process site: https://domain.sharepoint.com/sites/sitename. Unable to access repository (E:\\*VBOCacheName*\\PersistentCache\\repository.adb) JetError -1504, JET_errNullInvalid, Null not valid :: 0:03:27.\nSolution Raise a ticket with Veeam first—they’ll guide you in using eseutil.exe (a Microsoft tool for troubleshooting Exchange databases) to check database integrity.\nSteps we followed:\nRan an integrity check and repair. Deleted all cache files except the database, allowing Veeam to recreate them. Attempted another repair. Finally, we deleted the cache database and performed a re-sync. Since our database was only 80GB, this was completed within hours. They did warn me that this proess could take days if the .adb file is larger.\nI quote Veeam here, JET errors are notoriously hard to fix without a cache re-sync. They’re typically caused by a forcefully terminated open thread to the database, such as a server reboot.\nWarning: Possible team chat sync problem was detected An odd issue quickly fixed by Veeam Support: a mailbox tied to a Microsoft 365 group refused to back up, running for days without completing.\nVeeam advised against terminating jobs that are running outside the job Window and to allow atleast 2 retries for a job to minimise issues with throttling and JET based errors, see here for JET Errors.\nLog File snippet you should find 1 2 3 4 5 6 7 [05.08.2024 05:24:55.909] 68 (8380) Changed items: 0, deleted items: 0, read state changes: 100 [05.08.2024 05:24:55.909] 68 (8380) Warning: Possible team chat sync problem was detected [05.08.2024 05:24:55.914] 47 (5180) Processing mailbox: groupmailboxup@groups.domain.com... [05.08.2024 05:24:55.924] 47 (5180) Syncing folder items: Inbox... [05.08.2024 05:24:56.004] 47 (5180) Sync time: 0.0813057 [05.08.2024 05:24:56.004] 47 (5180) Changed items: 0, deleted items: 0, read state changes: 100 [05.08.2024 05:24:56.004] 47 (5180) Warning: Possible team chat sync problem was detected Fix Raise a ticket with Veeam first before going and doing anything yourself unless you are happy doing so.\nMake sure no jobs or restore sessions are running Stop the Veeam Backup for Microsoft 365 and Veeam Backup Proxy for Microsoft 365 services on the VBO 365 server and all backup proxies. Navigate to %ProgramData\\Veeam\\Backup365. Edit the proxy.xml file’s source line to include, FixTeamChatSync=\"True\". 1 2 3 4 5 6 7 8 ","wordCount":"1022","inLanguage":"en","image":"http://localhost:1313/%3Cimage%20path/url%3E","datePublished":"2024-12-30T16:05:01Z","dateModified":"2024-12-30T17:52:51Z","author":{"@type":"Person","name":"BassJamm"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:1313/posts/december2024/veeambackupforms365/"},"publisher":{"@type":"Organization","name":"BassJamm","logo":{"@type":"ImageObject","url":"http://localhost:1313/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://localhost:1313/ accesskey=h title="BassJamm (Alt + H)">BassJamm</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=http://localhost:1313/categories/ title=Categories><span>Categories</span></a></li><li><a href=http://localhost:1313/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://github.com/BassJamm/BassJamm.github.io/tree/main/content title=Github><span>Github</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=http://localhost:1313/external/ title="External Resources"><span>External Resources</span></a></li><li><a href=http://localhost:1313/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=http://localhost:1313/>Home</a>&nbsp;»&nbsp;<a href=http://localhost:1313/posts/>Posts</a>&nbsp;»&nbsp;<a href=http://localhost:1313/posts/december2024/veeambackupforms365/>Veeam Backup For Microsoft 365</a></div><h1 class="post-title entry-hint-parent">Veeam Backup For Microsoft 365</h1><div class=post-description>Notes on Issues, solutions and Reporting for the product</div><div class=post-meta><span title='2024-12-30 16:05:01 +0000 UTC'>December 30, 2024</span>&nbsp;·&nbsp;5 min&nbsp;·&nbsp;1022 words&nbsp;·&nbsp;BassJamm&nbsp;|&nbsp;<a href=https://github.com/BassJamm/BassJamm.github.io/tree/main/content/posts/December2024/VeeamBackupForMS365.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#intro aria-label=Intro>Intro</a></li><li><a href=#troubleshooting-scripts aria-label="Troubleshooting Scripts">Troubleshooting Scripts</a><ul><li><a href=#checking-the-last-backed-up-time-for-an-object aria-label="Checking the Last Backed up Time for an Object">Checking the Last Backed up Time for an Object</a></li><li><a href=#reviewing-the-vbo-logs aria-label="Reviewing the VBO Logs">Reviewing the VBO Logs</a></li><li><a href=#parsing-job-warnings-and-errors aria-label="Parsing Job Warnings and Errors">Parsing Job Warnings and Errors</a></li></ul></li><li><a href=#removing-a-users-license aria-label="Removing a User&rsquo;s License">Removing a User&rsquo;s License</a></li><li><a href=#best-practices-guide aria-label="Best Practices Guide">Best Practices Guide</a><ul><li><a href=#jet-database-errors aria-label="JET Database Errors">JET Database Errors</a><ul><li><a href=#error-example aria-label="Error Example">Error Example</a></li><li><a href=#solution aria-label=Solution>Solution</a></li></ul></li><li><a href=#warning-possible-team-chat-sync-problem-was-detected aria-label="Warning: Possible team chat sync problem was detected">Warning: Possible team chat sync problem was detected</a><ul><li><a href=#log-file-snippet-you-should-find aria-label="Log File snippet you should find">Log File snippet you should find</a></li><li><a href=#fix aria-label=Fix>Fix</a></li></ul></li></ul></li><li><a href=#reporting aria-label=Reporting>Reporting</a><ul><li><a href=#license-overview-report aria-label="License Overview Report">License Overview Report</a></li></ul></li></ul></div></details></div><div class=post-content><h2 id=intro>Intro<a hidden class=anchor aria-hidden=true href=#intro>#</a></h2><p>Veeam Backup for Microsoft 365 is a reliable solution, but after years of use, I’ve identified areas for improvement. Key challenges include:</p><ul><li><strong>Built-in Reporting</strong> Limited features often fall short of customer needs, requiring custom PowerShell scripts.</li><li><strong>Retention Periods</strong>: Difficult to audit, making it hard to track data outside of the backup retention window.</li><li><strong>SharePoint Script Issues</strong>: Pre-version 8, Microsoft&rsquo;s security settings frequently disabled script execution.</li><li><strong>Group Ownership Gaps</strong>: Groups without owners aren&rsquo;t backed up unless manually addressed.</li><li><strong>Backup Speed</strong>: Microsoft throttling significantly slows job completion times.</li><li><strong>Easy to lose control</strong>: We had various people\teams look after this product, configuration drift has really left it in a mess in places.</li></ul><p>Below, I&rsquo;m sharing what I have found, used and troubleshooted.</p><h2 id=troubleshooting-scripts>Troubleshooting Scripts<a hidden class=anchor aria-hidden=true href=#troubleshooting-scripts>#</a></h2><h3 id=checking-the-last-backed-up-time-for-an-object>Checking the Last Backed up Time for an Object<a hidden class=anchor aria-hidden=true href=#checking-the-last-backed-up-time-for-an-object>#</a></h3><blockquote><p><em>The notes below are for Item-Level Backups, which is based on the last modified date of the items within the backups (Emails, Files, Groups etc).</em>
<em>Snapshot level backup retention works the same way accept you lose the whole snapshot not just the items.</em></p></blockquote><p>An object is any one of the following item, User, Group, Site, Team, Organization, OneDrive, Mailbox. The script below helps identify when the object was last successfully backed up. Unfortunately, it does not identify which item in the backup is falling out of scope of the retention but, does give an idea of when items will start being removed from the backup job.</p><p>For example, in a SharePoint site, the file &ldquo;Don&rsquo;t Delete Me&rdquo;, was last modified on the 1st of September 2021. If the retention is 3 years, the document would have been removed from the backups 4 months ago, but, other data in that site may have been edited in 2024 and so is still in scope of the retention.</p><blockquote><p><em>I went a bit mad on the <code>Write-Host</code> commands in this script but, the staff who&rsquo;d be running this are not all savvy with Powershell so thought more information was better.</em></p></blockquote><script src=https://gist.github.com/BassJamm/b9c5729e3439b69fcf3dc18c6091caf9.js></script><h3 id=reviewing-the-vbo-logs>Reviewing the VBO Logs<a hidden class=anchor aria-hidden=true href=#reviewing-the-vbo-logs>#</a></h3><p>You can download the logs using the Veeam Console.</p><ol><li>Open the Console.</li><li>Click the Hamburger Menu in the top left.</li><li>Select Help and Support.</li><li>Select Support Information.</li><li>With Collect Logs selected, Click next.</li><li>Select the proxy server your job is running via.</li><li>Save the logs to a good location and extract them.</li></ol><p>The script below doesn&rsquo;t perform many complex actions; it simply removes some square brackets and creates separate date and time variables in their own columns. However, it simplifies the process, making it easier to continue searching, formatting, and exporting the logs from PowerShell.</p><blockquote><p><em>Some of the logs can be over 100,000 lines so there is a progress bar written into the <code>foreach</code> loop for some visual feedback.</em></p></blockquote><script src=https://gist.github.com/BassJamm/66e23d30075df3fa74a748d4f199e727.js></script><h3 id=parsing-job-warnings-and-errors>Parsing Job Warnings and Errors<a hidden class=anchor aria-hidden=true href=#parsing-job-warnings-and-errors>#</a></h3><p>It&rsquo;s quite useful to be able to pull out any warnings or errors from the previous jobs. Below is a script that can help do that.</p><blockquote><p><em>The <code>starttime</code> is optional, if you do not provide it, it will provide the most recent job matching the name you provide. Make sure to enter the <code>starttime</code> as a string like the example shows.</em></p></blockquote><script src=https://gist.github.com/BassJamm/dba4ed04d761c0d0fba96f89d3e4069e.js></script><h2 id=removing-a-users-license>Removing a User&rsquo;s License<a hidden class=anchor aria-hidden=true href=#removing-a-users-license>#</a></h2><p>This process can be a bit of a pig, there is a Veeam Blog or KB post <a href=https://www.veeam.com/blog/remove-user-license-vbo365.html>here</a>.</p><h2 id=best-practices-guide>Best Practices Guide<a hidden class=anchor aria-hidden=true href=#best-practices-guide>#</a></h2><p>If you are looking for what Veeam suggest about how to setup and use this solution, there&rsquo;s a guide <a href=https://bp.veeam.com/vb365/>here</a> for version 7.</p><h3 id=jet-database-errors>JET Database Errors<a hidden class=anchor aria-hidden=true href=#jet-database-errors>#</a></h3><blockquote><p><em>This will not be an issue once upgraded to version 8 as they have swapped over to Postgresql instead of JET.</em></p></blockquote><h4 id=error-example>Error Example<a hidden class=anchor aria-hidden=true href=#error-example>#</a></h4><p>Example error, <code>21/03/2024 20:28:39 :: Failed to process site: https://domain.sharepoint.com/sites/sitename. Unable to access repository (E:\*VBOCacheName*\PersistentCache\repository.adb) JetError -1504, JET_errNullInvalid, Null not valid :: 0:03:27</code>.</p><h4 id=solution>Solution<a hidden class=anchor aria-hidden=true href=#solution>#</a></h4><p>Raise a ticket with Veeam first—they’ll guide you in using eseutil.exe (a Microsoft tool for troubleshooting Exchange databases) to check database integrity.</p><p>Steps we followed:</p><ul><li>Ran an integrity check and repair.</li><li>Deleted all cache files except the database, allowing Veeam to recreate them.</li><li>Attempted another repair.</li></ul><p>Finally, we deleted the cache database and performed a re-sync. Since our database was only 80GB, this was completed within hours. They did warn me that this proess could take days if the <code>.adb</code> file is larger.</p><blockquote><p><em>I quote Veeam here, JET errors are notoriously hard to fix without a cache re-sync. They’re typically caused by a forcefully terminated open thread to the database, such as a server reboot.</em></p></blockquote><h3 id=warning-possible-team-chat-sync-problem-was-detected>Warning: Possible team chat sync problem was detected<a hidden class=anchor aria-hidden=true href=#warning-possible-team-chat-sync-problem-was-detected>#</a></h3><p>An odd issue quickly fixed by Veeam Support: a mailbox tied to a Microsoft 365 group refused to back up, running for days without completing.</p><blockquote><p><em>Veeam advised against terminating jobs that are running outside the job Window and to allow atleast 2 retries for a job to minimise issues with throttling and JET based errors, see <a href=#jet-database-errors>here for JET Errors</a>.</em></p></blockquote><h4 id=log-file-snippet-you-should-find>Log File snippet you should find<a hidden class=anchor aria-hidden=true href=#log-file-snippet-you-should-find>#</a></h4><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>[05.08.2024 05:24:55.909]   68 (8380)  Changed items: 0, deleted items: 0, read state changes: 100  
</span></span><span style=display:flex><span>[05.08.2024 05:24:55.909]   68 (8380) Warning: Possible team chat sync problem was detected  
</span></span><span style=display:flex><span>[05.08.2024 05:24:55.914]   47 (5180) Processing mailbox: groupmailboxup@groups.domain.com...  
</span></span><span style=display:flex><span>[05.08.2024 05:24:55.924]   47 (5180) Syncing folder items: Inbox...  
</span></span><span style=display:flex><span>[05.08.2024 05:24:56.004]   47 (5180)  Sync time: 0.0813057  
</span></span><span style=display:flex><span>[05.08.2024 05:24:56.004]   47 (5180)  Changed items: 0, deleted items: 0, read state changes: 100  
</span></span><span style=display:flex><span>[05.08.2024 05:24:56.004]   47 (5180) Warning: Possible team chat sync problem was detected
</span></span></code></pre></td></tr></table></div></div><h4 id=fix>Fix<a hidden class=anchor aria-hidden=true href=#fix>#</a></h4><blockquote><p><em>Raise a ticket with Veeam first before going and doing anything yourself unless you are happy doing so.</em></p></blockquote><ol><li>Make sure no jobs or restore sessions are running</li><li>Stop the Veeam Backup for Microsoft 365 and Veeam Backup Proxy for Microsoft 365 services on the VBO 365 server and all backup proxies.</li><li>Navigate to <code>%ProgramData\Veeam\Backup365</code>.</li><li>Edit the <code>proxy.xml</code> file&rsquo;s source line to include, <code>FixTeamChatSync="True"</code>.</li></ol><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">8
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#f92672>&lt;Veeam&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;Archiver&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;Source</span> <span style=color:#a6e22e>FixTeamChatSync=</span><span style=color:#e6db74>&#34;True&#34;</span> <span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>.
</span></span><span style=display:flex><span>.
</span></span><span style=display:flex><span>.
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;/Archiver&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;/Veeam&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=reporting>Reporting<a hidden class=anchor aria-hidden=true href=#reporting>#</a></h2><p>As I mentioned to begin with, the reporting is one place that we have had to rely quite heavily on the Powershell commands for. Below are some examples.</p><h3 id=license-overview-report>License Overview Report<a hidden class=anchor aria-hidden=true href=#license-overview-report>#</a></h3><p>A simple set of commands that will give you the license overview report for all organisations in your VBO solution.</p><script src=https://gist.github.com/BassJamm/a3bde39518387ab1e3db4469e65beb06.js></script><p>Hope this helps someone!</p></div><footer class=post-footer><ul class=post-tags><li><a href=http://localhost:1313/tags/veeam/>Veeam</a></li><li><a href=http://localhost:1313/tags/microsoft365/>Microsoft365</a></li></ul><nav class=paginav><a class=prev href=http://localhost:1313/posts/december2024/uninstallmcafee/><span class=title>« Prev</span><br><span>Uninstall McAfee</span>
</a><a class=next href=http://localhost:1313/posts/december2024/diagnosing-autopilot-issues/><span class=title>Next »</span><br><span>Diagnosing Autopilot Issues for Windows Devices</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2024 <a href=http://localhost:1313/>BassJamm</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>