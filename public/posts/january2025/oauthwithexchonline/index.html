<!doctype html><html lang=en dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Sending email with SMTP via Exchange Online using OAuth | BassJamm</title>
<meta name=keywords content="Exchange Online,SMTP"><meta name=description content="How to use OAuth to send email using Exchange Online"><meta name=author content="BassJamm"><link rel=canonical href=https://canonical.url/to/page><link crossorigin=anonymous href=/assets/css/stylesheet.814f031cd60cbd7b48a5165060804c53269aa044f570ef83b17e6f13369ad378.css integrity="sha256-gU8DHNYMvXtIpRZQYIBMUyaaoET1cO+DsX5vEzaa03g=" rel="preload stylesheet" as=style><link rel=icon href=http://localhost:1313/assets/favicon.ico><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/assets/favicon.ico><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/assets/favicon.ico><link rel=apple-touch-icon href=http://localhost:1313/assets/favicon.ico><link rel=mask-icon href=http://localhost:1313/assets/favicon.ico><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=http://localhost:1313/posts/january2025/oauthwithexchonline/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="http://localhost:1313/posts/january2025/oauthwithexchonline/"><meta property="og:site_name" content="BassJamm"><meta property="og:title" content="Sending email with SMTP via Exchange Online using OAuth"><meta property="og:description" content="How to use OAuth to send email using Exchange Online"><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-01-01T21:53:04+00:00"><meta property="article:modified_time" content="2025-01-01T22:11:11+00:00"><meta property="article:tag" content="Exchange Online"><meta property="article:tag" content="SMTP"><meta property="og:image" content="http://localhost:1313/%3Cimage%20path/url%3E"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://localhost:1313/%3Cimage%20path/url%3E"><meta name=twitter:title content="Sending email with SMTP via Exchange Online using OAuth"><meta name=twitter:description content="How to use OAuth to send email using Exchange Online"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://localhost:1313/posts/"},{"@type":"ListItem","position":2,"name":"Sending email with SMTP via Exchange Online using OAuth","item":"http://localhost:1313/posts/january2025/oauthwithexchonline/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Sending email with SMTP via Exchange Online using OAuth","name":"Sending email with SMTP via Exchange Online using OAuth","description":"How to use OAuth to send email using Exchange Online","keywords":["Exchange Online","SMTP"],"articleBody":"The below summarises the steps to setup emailing via an account using SMTP with Exchange Online.\nI didn’t come up with this information, you can find all of it detailed at this reference link\nComponents Enterprise App - Which will provide the OAuth token. Email Account - Which will be sending the email. PowerShell Script - They way in which you can send the mail. I am specifically covering the 2nd option to use an Enterprise Application. To use OAUTH, the access token is required. There are two ways to retrieve the access token from Microsoft server:\nUser login the account by web browser, the application uses the returned authorization code to request the access token. This way requires user interactive attending, it is not suitable for server-side application.\nSetup the Enterprise Application Register the application in Azure Portal. Note the client id and tenant id. Assign API permission to the application. Click Add Permissions. Select APIs in my organization uses -\u003e Office 365 Exchange Online -\u003e Application Permission. Find the relevant permissions of the following, POP.AccessAsApp permission, IMAP.AccessAsApp permission, SMTP.AccessAsApp permission. Grant Admin consent for the Organisation. Create a client secret or Certificate. Register SMTP/POP/IMAP service principals in Exchange This will be given permissions to send on behalf of the account you want to use.\nFind your APPLICATION_ID and OBJECT_ID. Open Exchange Online PowerShell to run the cmdlet. Connect-ExchangeOnline, this will launch a browser. Create your new service principal, New-ServicePrincipal -AppId \"yourappID\" -ServiceId \"serviceprincialId\" Query it and check it is there, Get-ServicePrincipal. Add the specific mailboxes in the tenant that will be allowed to be access by your application. User is the serviceId. Add-MailboxPermission -Identity \"grant-test@domain.com\" -User \"serviceprincialId\" -AccessRights FullAccess. Enable SMTP Auth per Account Microsoft Document Link for where the commands below have come from\n1 2 # Add one of the following to the end of this command, \u003c$true | $false | $null\u003e Set-CASMailbox -Identity -SmtpClientAuthenticationDisabled This example enables SMTP AUTH for mailbox sean@contoso.com.\n1 Set-CASMailbox -Identity sean@contoso.com -SmtpClientAuthenticationDisabled $false This example disables SMTP AUTH for mailbox chris@contoso.com.\n1 Set-CASMailbox -Identity chris@contoso.com -SmtpClientAuthenticationDisabled $true Reporting SMTP Auth Status 1 2 3 4 5 6 7 8 9 # Gather all mailboxes where SMTP AUTH is disabled # ? = Where-Object Get-CASMailbox -ResultSize unlimited | ? {$_.SmtpClientAuthenticationDisabled -eq $true} # Gather all mailboxes where SMTP AUTH is enabled Get-CASMailbox -ResultSize unlimited | ? ($_.SmtpClientAuthenticationDisabled -eq $false) # Gather all mailboxes where the setting is controlled by org settings Get-CASMailbox -ResultSize unlimited | ? ($_.SmtpClientAuthenticationDisabled -eq $null) Script to test this out In-progress\n","wordCount":"426","inLanguage":"en","image":"http://localhost:1313/%3Cimage%20path/url%3E","datePublished":"2025-01-01T21:53:04Z","dateModified":"2025-01-01T22:11:11Z","author":{"@type":"Person","name":"BassJamm"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:1313/posts/january2025/oauthwithexchonline/"},"publisher":{"@type":"Organization","name":"BassJamm","logo":{"@type":"ImageObject","url":"http://localhost:1313/assets/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://localhost:1313/ accesskey=h title="BassJamm (Alt + H)">BassJamm</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=http://localhost:1313/categories/ title=Categories><span>Categories</span></a></li><li><a href=http://localhost:1313/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://github.com/BassJamm/BassJamm.github.io/tree/main/content title=Github><span>Github</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=http://localhost:1313/external/ title="External Resources"><span>External Resources</span></a></li><li><a href=http://localhost:1313/archives title=Archives><span>Archives</span></a></li><li><a href=http://localhost:1313/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=http://localhost:1313/>Home</a>&nbsp;»&nbsp;<a href=http://localhost:1313/posts/>Posts</a>&nbsp;»&nbsp;<a href=http://localhost:1313/posts/january2025/oauthwithexchonline/>Sending email with SMTP via Exchange Online using OAuth</a></div><h1 class="post-title entry-hint-parent">Sending email with SMTP via Exchange Online using OAuth</h1><div class=post-description>How to use OAuth to send email using Exchange Online</div><div class=post-meta><span title='2025-01-01 21:53:04 +0000 UTC'>January 1, 2025</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;426 words&nbsp;·&nbsp;BassJamm&nbsp;|&nbsp;<a href=https://github.com/BassJamm/BassJamm.github.io/tree/main/content/posts/January2025/OAuthwithExchOnline.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#components aria-label=Components>Components</a></li><li><a href=#setup-the-enterprise-application aria-label="Setup the Enterprise Application">Setup the Enterprise Application</a></li><li><a href=#register-smtppopimap-service-principals-in-exchange aria-label="Register SMTP/POP/IMAP service principals in Exchange">Register SMTP/POP/IMAP service principals in Exchange</a></li><li><a href=#enable-smtp-auth-per-account aria-label="Enable SMTP Auth per Account">Enable SMTP Auth per Account</a><ul><li><a href=#reporting-smtp-auth-status aria-label="Reporting SMTP Auth Status">Reporting SMTP Auth Status</a></li></ul></li><li><a href=#script-to-test-this-out aria-label="Script to test this out">Script to test this out</a></li></ul></div></details></div><div class=post-content><p>The below summarises the steps to setup emailing via an account using SMTP with Exchange Online.</p><blockquote><p><em>I didn&rsquo;t come up with this information, you can find all of it detailed at this <a href=https://www.emailarchitect.net/eaoauth/kb/azure_application_pop_imap_grant.aspx>reference link</a></em></p></blockquote><h2 id=components>Components<a hidden class=anchor aria-hidden=true href=#components>#</a></h2><ul><li>Enterprise App - Which will provide the OAuth token.</li><li>Email Account - Which will be sending the email.</li><li>PowerShell Script - They way in which you can send the mail.</li></ul><blockquote><p><em>I am specifically covering the 2nd option to use an Enterprise Application.</em>
<em>To use OAUTH, the access token is required. There are two ways to retrieve the access token from Microsoft server:</em></p><p><em>User login the account by web browser, the application uses the returned authorization code to request the access token. This way requires user interactive attending, it is not suitable for server-side application.</em></p></blockquote><h2 id=setup-the-enterprise-application>Setup the Enterprise Application<a hidden class=anchor aria-hidden=true href=#setup-the-enterprise-application>#</a></h2><ol><li>Register the application in Azure Portal.</li><li>Note the <code>client id</code> and <code>tenant id</code>.</li><li>Assign API permission to the application.</li><li>Click Add Permissions.</li><li>Select <code>APIs in my organization uses</code> -> <code>Office 365 Exchange Online</code> -> <code>Application Permission</code>.</li><li>Find the relevant permissions of the following, <code>POP.AccessAsApp permission</code>, <code>IMAP.AccessAsApp permission</code>, <code>SMTP.AccessAsApp permission</code>.</li><li>Grant Admin consent for the Organisation.</li><li>Create a client secret or Certificate.</li></ol><h2 id=register-smtppopimap-service-principals-in-exchange>Register SMTP/POP/IMAP service principals in Exchange<a hidden class=anchor aria-hidden=true href=#register-smtppopimap-service-principals-in-exchange>#</a></h2><blockquote><p><em>This will be given permissions to send on behalf of the account you want to use.</em></p></blockquote><ol><li>Find your <code>APPLICATION_ID</code> and <code>OBJECT_ID</code>.</li><li>Open <a href="https://learn.microsoft.com/en-us/powershell/exchange/connect-to-exchange-online-powershell?view=exchange-ps">Exchange Online PowerShell</a> to run the cmdlet.</li><li><code>Connect-ExchangeOnline</code>, this will launch a browser.</li><li>Create your new service principal, <code>New-ServicePrincipal -AppId "yourappID" -ServiceId "serviceprincialId"</code></li><li>Query it and check it is there, <code>Get-ServicePrincipal</code>.</li><li>Add the specific mailboxes in the tenant that will be allowed to be access by your application.</li><li>User is the serviceId.</li><li><code>Add-MailboxPermission -Identity "grant-test@domain.com" -User "serviceprincialId" -AccessRights FullAccess</code>.</li></ol><h2 id=enable-smtp-auth-per-account>Enable SMTP Auth per Account<a hidden class=anchor aria-hidden=true href=#enable-smtp-auth-per-account>#</a></h2><p><a href=https://learn.microsoft.com/en-us/exchange/clients-and-mobile-in-exchange-online/authenticated-client-smtp-submission#use-exchange-online-powershell-to-enable-or-disable-smtp-auth-on-specific-mailboxes>Microsoft Document Link for where the commands below have come from</a></p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#75715e># Add one of the following to the end of this command, &lt;$true | $false | $null&gt;</span>
</span></span><span style=display:flex><span>Set-CASMailbox -Identity &lt;MailboxId&gt; -SmtpClientAuthenticationDisabled &lt;here&gt;
</span></span></code></pre></td></tr></table></div></div><p>This example enables SMTP AUTH for mailbox <code>sean@contoso.com</code>.</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>Set-CASMailbox -Identity sean@contoso.com -SmtpClientAuthenticationDisabled $false
</span></span></code></pre></td></tr></table></div></div><p>This example disables SMTP AUTH for mailbox <code>chris@contoso.com</code>.</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>Set-CASMailbox -Identity chris@contoso.com -SmtpClientAuthenticationDisabled $true
</span></span></code></pre></td></tr></table></div></div><h3 id=reporting-smtp-auth-status>Reporting SMTP Auth Status<a hidden class=anchor aria-hidden=true href=#reporting-smtp-auth-status>#</a></h3><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">9
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#75715e># Gather all mailboxes where SMTP AUTH is disabled</span>
</span></span><span style=display:flex><span><span style=color:#75715e># ? = Where-Object</span>
</span></span><span style=display:flex><span>Get-CASMailbox -ResultSize unlimited | ? {$_.SmtpClientAuthenticationDisabled <span style=color:#f92672>-eq</span> $true}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Gather all mailboxes where SMTP AUTH is enabled</span>
</span></span><span style=display:flex><span>Get-CASMailbox -ResultSize unlimited | ? ($_.SmtpClientAuthenticationDisabled <span style=color:#f92672>-eq</span> $false)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Gather all mailboxes where the setting is controlled by org settings</span>
</span></span><span style=display:flex><span>Get-CASMailbox -ResultSize unlimited | ? ($_.SmtpClientAuthenticationDisabled <span style=color:#f92672>-eq</span> $null)
</span></span></code></pre></td></tr></table></div></div><h2 id=script-to-test-this-out>Script to test this out<a hidden class=anchor aria-hidden=true href=#script-to-test-this-out>#</a></h2><p>In-progress</p></div><footer class=post-footer><ul class=post-tags><li><a href=http://localhost:1313/tags/exchange-online/>Exchange Online</a></li><li><a href=http://localhost:1313/tags/smtp/>SMTP</a></li></ul><nav class=paginav><a class=prev href=http://localhost:1313/posts/january2025/customisepwshprompt/><span class=title>« Prev</span><br><span>Customise your PowerShell prompt</span>
</a><a class=next href=http://localhost:1313/posts/january2025/nsgassistance/><span class=title>Next »</span><br><span>Network Security Group (NSG) Assistance</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2025 <a href=http://localhost:1313/>BassJamm</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>