<!doctype html><html lang=en dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Automating Scripts in Azure | BassJamm</title>
<meta name=keywords content="Azure,"><meta name=description content="Automating your first script in Azure"><meta name=author content="BassJamm"><link rel=canonical href=https://canonical.url/to/page><link crossorigin=anonymous href=/assets/css/stylesheet.41c419db08dea7f390c61662b53c49bea8d21db9340511ea986567a56b218f72.css integrity="sha256-QcQZ2wjep/OQxhZitTxJvqjSHbk0BRHqmGVnpWshj3I=" rel="preload stylesheet" as=style><link rel=icon href=http://localhost:1313/assets/favicon.ico><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/assets/favicon.ico><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/assets/favicon.ico><link rel=apple-touch-icon href=http://localhost:1313/assets/favicon.ico><link rel=mask-icon href=http://localhost:1313/assets/favicon.ico><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=http://localhost:1313/posts/march2024/automationaccounts/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="http://localhost:1313/posts/march2024/automationaccounts/"><meta property="og:site_name" content="BassJamm"><meta property="og:title" content="Automating Scripts in Azure"><meta property="og:description" content="Automating your first script in Azure"><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-03-05T22:00:18+00:00"><meta property="article:modified_time" content="2025-03-05T22:00:18+00:00"><meta property="article:tag" content="Azure"><meta property="og:image" content="http://localhost:1313/%3Cimage%20path/url%3E"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://localhost:1313/%3Cimage%20path/url%3E"><meta name=twitter:title content="Automating Scripts in Azure"><meta name=twitter:description content="Automating your first script in Azure"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://localhost:1313/posts/"},{"@type":"ListItem","position":2,"name":"Automating Scripts in Azure","item":"http://localhost:1313/posts/march2024/automationaccounts/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Automating Scripts in Azure","name":"Automating Scripts in Azure","description":"Automating your first script in Azure","keywords":["Azure",""],"articleBody":"Quick Intro A year or so ago, I dabbled with Automation Accounts but ran into enough frustrations that I opted to host scripts on a Windows Server instead. Recently, I decided to give it another shot, needing to get something up and running without an appropriate Windows machine being available. This time, whether the platform has improved or I was the problem all along, everything went much more smoothly.\nWhy the need to do this? I’ve used SCCM in the past to manage endpoints, and it provides a wide range of reports, covering everything from updates and antivirus status to application installs and more. While it’s definitely possible to retrieve similar data from Intune, my requirement was different: I needed a way to access these reports without having to log in to retrieve them.\nThe reports I’m after are the Detected Apps report and a report of apps installed per device.\nWhat Needs Doing Here are the steps I took (though there are likely better ways—so don’t take this as gospel):\nSet up an Automation Account. Install the relevant PowerShell modules. Create an App Registration to facilitate authentication. Create a Runbook, upload the script, and test it. Set up the schedule. Creating the Automation Account I’m not going to regurgitate the Microsoft document so, check out the link below for creating an Automation Account. When/if you do, for what I did, you would not need to setup any identities, I’ll outline setting up the same as I did in a further step.#TODO - Add link to section here.\nCreate a standalone Azure Automation account\nInstalling Modules Below is the listof modules I used; SendGrid is the method I like to use for relaying emails.\nMicrosoft.Graph.Authentication. #TODO - Add modules. Create an App Registration to facilitate authentication Create a Runbook, upload the script, and test it Set up the schedule ","wordCount":"309","inLanguage":"en","image":"http://localhost:1313/%3Cimage%20path/url%3E","datePublished":"2025-03-05T22:00:18Z","dateModified":"2025-03-05T22:00:18Z","author":{"@type":"Person","name":"BassJamm"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:1313/posts/march2024/automationaccounts/"},"publisher":{"@type":"Organization","name":"BassJamm","logo":{"@type":"ImageObject","url":"http://localhost:1313/assets/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://localhost:1313/ accesskey=h title="BassJamm (Alt + H)">BassJamm</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=http://localhost:1313/categories/ title=Categories><span>Categories</span></a></li><li><a href=http://localhost:1313/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://github.com/BassJamm/BassJamm.github.io/tree/main/content title=Github><span>Github</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=http://localhost:1313/external/ title="External Resources"><span>External Resources</span></a></li><li><a href=http://localhost:1313/archives title=Archives><span>Archives</span></a></li><li><a href=http://localhost:1313/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=http://localhost:1313/>Home</a>&nbsp;»&nbsp;<a href=http://localhost:1313/posts/>Posts</a>&nbsp;»&nbsp;<a href=http://localhost:1313/posts/march2024/automationaccounts/>Automating Scripts in Azure</a></div><h1 class="post-title entry-hint-parent">Automating Scripts in Azure</h1><div class=post-description>Automating your first script in Azure</div><div class=post-meta><span title='2025-03-05 22:00:18 +0000 UTC'>March 5, 2025</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;309 words&nbsp;·&nbsp;BassJamm&nbsp;|&nbsp;<a href=https://github.com/BassJamm/BassJamm.github.io/tree/main/content/posts/March2024/automationaccounts/index.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#quick-intro aria-label="Quick Intro">Quick Intro</a></li><li><a href=#why-the-need-to-do-this aria-label="Why the need to do this?">Why the need to do this?</a></li><li><a href=#what-needs-doing aria-label="What Needs Doing">What Needs Doing</a><ul><li><a href=#creating-the-automation-account aria-label="Creating the Automation Account">Creating the Automation Account</a></li><li><a href=#installing-modules aria-label="Installing Modules">Installing Modules</a></li><li><a href=#create-an-app-registration-to-facilitate-authentication aria-label="Create an App Registration to facilitate authentication">Create an App Registration to facilitate authentication</a></li><li><a href=#create-a-runbook-upload-the-script-and-test-it aria-label="Create a Runbook, upload the script, and test it">Create a Runbook, upload the script, and test it</a></li><li><a href=#set-up-the-schedule aria-label="Set up the schedule">Set up the schedule</a></li></ul></li></ul></div></details></div><div class=post-content><h2 id=quick-intro>Quick Intro<a hidden class=anchor aria-hidden=true href=#quick-intro>#</a></h2><p>A year or so ago, I dabbled with Automation Accounts but ran into enough frustrations that I opted to host scripts
on a Windows Server instead. Recently, I decided to give it another shot, needing to get something up and running
without an appropriate Windows machine being available. This time, whether the platform has improved or I was the
problem all along, everything went much more smoothly.</p><h2 id=why-the-need-to-do-this>Why the need to do this?<a hidden class=anchor aria-hidden=true href=#why-the-need-to-do-this>#</a></h2><p>I&rsquo;ve used SCCM in the past to manage endpoints, and it provides a wide range of reports, covering everything from updates
and antivirus status to application installs and more. While it&rsquo;s definitely possible to retrieve similar data from Intune,
my requirement was different: I needed a way to access these reports without having to log in to retrieve them.</p><p>The reports I&rsquo;m after are the Detected Apps report and a report of apps installed per device.</p><h2 id=what-needs-doing>What Needs Doing<a hidden class=anchor aria-hidden=true href=#what-needs-doing>#</a></h2><p>Here are the steps I took (though there are likely better ways—so don’t take this as gospel):</p><ul><li>Set up an Automation Account.</li><li>Install the relevant PowerShell modules.</li><li>Create an App Registration to facilitate authentication.</li><li>Create a Runbook, upload the script, and test it.</li><li>Set up the schedule.</li></ul><h3 id=creating-the-automation-account>Creating the Automation Account<a hidden class=anchor aria-hidden=true href=#creating-the-automation-account>#</a></h3><p>I&rsquo;m not going to regurgitate the Microsoft document so, check out the link below for creating an Automation Account.
When/if you do, for what I did, you would not need to setup any identities, I&rsquo;ll outline setting up the same as I did
in a further step.#TODO - Add link to section here.</p><p><a href="https://learn.microsoft.com/en-us/azure/automation/automation-create-standalone-account?tabs=azureportal#create-a-new-automation-account-in-the-azure-portal">Create a standalone Azure Automation account</a></p><h3 id=installing-modules>Installing Modules<a hidden class=anchor aria-hidden=true href=#installing-modules>#</a></h3><p>Below is the listof modules I used; SendGrid is the method I like to use for relaying emails.</p><ul><li>Microsoft.Graph.Authentication.</li><li>#TODO - Add modules.</li></ul><h3 id=create-an-app-registration-to-facilitate-authentication>Create an App Registration to facilitate authentication<a hidden class=anchor aria-hidden=true href=#create-an-app-registration-to-facilitate-authentication>#</a></h3><h3 id=create-a-runbook-upload-the-script-and-test-it>Create a Runbook, upload the script, and test it<a hidden class=anchor aria-hidden=true href=#create-a-runbook-upload-the-script-and-test-it>#</a></h3><h3 id=set-up-the-schedule>Set up the schedule<a hidden class=anchor aria-hidden=true href=#set-up-the-schedule>#</a></h3></div><footer class=post-footer><ul class=post-tags><li><a href=http://localhost:1313/tags/azure/>Azure</a></li></ul><nav class=paginav><a class=next href=http://localhost:1313/posts/feburary2025/intuneapptroubleshootingpost3/><span class=title>Next »</span><br><span>Intune App Troubleshooting: Intune Management Extension Logs</span></a></nav></footer></article></main><footer class=footer>This is either not a post or has no "gitInfo"...<br><span>&copy; 2025 <a href=http://localhost:1313/>BassJamm</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>